{
  "status_code": 201,
  "title": "FastAPIとDockerの基礎理解と実践ポイント",
  "author": "d3c0B",
  "content": "## FastAPIエントリーポイントの基本\n\nFastAPIのエントリーポイントはシンプルで、`from web import app`だけで動作する。ただし、実際の起動はASGIサーバー（uvicornなど）が担当する。\n\n### 開発環境での実行\n- `uvicorn web:app --reload`\n- 文字列で指定する理由：リロード機能を動作させるため\n\n### 本番環境での考慮点\n- Dockerを使用する場合、`if __name__ == \"__main__\":`ブロックは不要\n- Dockerfileやdocker-compose.ymlで直接uvicornコマンドを実行する\n\n## Dockerとコンテナ管理の理解\n\n### docker-composeの役割\n- 複数コンテナの統合管理ツール\n- 開発環境でのデータベース、Webアプリ、Redisなどの一括起動に便利\n- 本番環境では、小規模アプリやVPSでの運用に限定的\n\n### docker runとの違い\n- `docker run`：単一コンテナの手動管理\n- `docker-compose up`：定義ファイルに基づく複数コンテナの一括管理\n\n## 本番環境での構成\n\n### クラウドサービスへの分割\n- アプリケーション：ECS（AWS）、Cloud Run（GCP）\n- データベース：RDS（AWS）、Cloud SQL（GCP）\n- 通信：VPC内でのプライベート接続\n\n### ステートフルとステートレスの違い\n- **ステートフル**：データを保持（データベースなど）\n- **ステートレス**：状態を保持しない（Webアプリサーバーなど）\n\n## FastAPIのテンプレートと静的ファイル\n\n### Jinja2の使用\n- FastAPI + Jinja2は普通に使われる組み合わせ\n- 管理画面やシンプルなフォームに適している\n- React/Vueは複雑なUIやSPAが必要な場合に検討\n\n### 静的ファイルの配信\n```python\napp.mount(\"/static\", StaticFiles(directory=\"static\"), name=\"static\")\n```\n- テンプレート内での使用：`{{ url_for('static', path='/css/style.css') }}`\n- `name=\"static\"`は識別子で、URLパスと直接対応しない\n\n## 非同期処理の理解\n\n### awaitの本質\n- 処理速度ではなく「非同期性そのもの」が重要\n- 完了を待つ必要がある処理に使用\n- 非同期対応ライブラリが必要（httpx、asyncpgなど）\n\n### FastAPIの強み\n1. アプリケーション内部の非同期（実装レベル）\n2. サーバーレベルの非同期（複数ユーザー同時処理）\n\n## コストとパフォーマンス\n\n### Uvicorn vs Gunicorn\n- **Uvicorn**：ASGIサーバー、非同期対応、1プロセスでも高効率\n- **Gunicorn**：WSGIサーバー、同期処理、複数ワーカー必要\n\n### クラウドコストの目安\n- 小規模（数百〜数千ユーザー/月）：$20〜80/月\n- 中規模（数万ユーザー/月）：$200〜800/月\n- chatlog-2-hatenaのような個人用途：$0〜5/月（無料枠内）\n\n## 実践的な学び\n\n1. **環境変数管理**：開発時は.env、本番はSecrets Managerを使用\n2. **ファイルアップロード**：`UploadFile`を使用して効率的な処理\n3. **ルーティング**：小規模なら`@app.get`、規模が大きくなったら`APIRouter`を検討\n4. **非同期処理**：既存コードが直列処理なら、無理に非同期化する必要はない\n\nこの記事は deepseek-chat により自動生成されています。",
  "time": "2025-12-23T00:19:57.996915+09:00",
  "link_edit": "https://blog.hatena.ne.jp/d3c0B/d3c0.hatenablog.com/atom/entry/17179246901335662372",
  "link_edit_user": "https://blog.hatena.ne.jp/d3c0B/d3c0.hatenablog.com/edit?entry=17179246901335662372",
  "link_alternate": "https://d3c0.hatenablog.com/entry/2025/12/23/001957",
  "categories": ["FastAPI", "Docker", "非同期処理", "クラウドデプロイ"],
  "is_draft": false
}
